<html>
    <head>
        <title>Novacare</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </head>
    <body>
        <div class="container mt-5">
            <h2>Start a New Conversation</h2>
            
            <form method="GET" action="{% url 'messaging:start_conversation' %}" class="input-group mb-4">
                <input type="search" name="q" class="form-control" placeholder="Search by username or email" value="{{ query|default:'' }}">
                <button class="btn btn-outline-secondary" type="submit">Search</button>
            </form>

            {% if query and not users %}
                <div class="alert alert-warning">No users found matching "{{ query }}".</div>
            {% elif users %}
                <h3>Search Results:</h3>
                <div class="list-group">
                    {% for user in users %}
                        <a href="{% url 'messaging:create_or_get_conversation' user.username %}" class="list-group-item list-group-item-action">
                            {{ user.username }} ({{ user.email }})
                        </a>
                    {% endfor %}
                </div>
            {% else %}
                <div class="alert alert-info">Enter a username or email above to find someone to chat with.</div>
            {% endif %}

            <div class="mt-4">
                <a href="{% url 'messaging:conversation_list' %}" class="btn btn-secondary">Back to Inbox</a>
            </div>
        </div>
    </body>
</html>